{% extends "base.html" %}

{% load fontawesome_5 %}
{% load helpers %}

{% block content %}
<h1>Federation::Server</h1>

<table class="table">
	<thead>
		<tr>
			<th>Name</th>
			<th>Pull URL</th>
			<th>Pulled server</th>
			<th><a class="btn btn-sm btn-primary float-right" href="{% url 'fed:server-create' %}">{% fa5_icon 'plus' %} New server</a></th>
		</tr>
	</thead>
{% for server in object_list %}
	<tr{% if not server.enabled %} class="table-secondary"{% endif %}>
		<th>{% enabled_icon server %} <a href="{{ server.get_absolute_url }}">{% if server.is_this_server %}{% fa5_icon 'home' %}{% endif %} {{ server.name }}</a></th>
		<td {% if not server.pull_enabled %}class="table-secondary"{% endif %}>
			{% enabled_icon server 'pull_enabled' %}
			{% if server.is_pull_recent %}
				{% fa5_icon 'cloud-download-alt' color='green' %}
			{% else %}
				{% fa5_icon 'cloud-download-alt' color='red' %}
			{% endif %}
			<code>{{ server.pull_url }}</code>
		</td>
		<td>{% for s in server.pull_servers.all %}<span class="badge badge-secondary">{{ s.name}}</span> {% endfor %}</td>
		<td>
			{% if server.enabled %}
				<a class="btn btn-sm btn-secondary" href="{% url 'fed:server-disable' server.pk %}">{% fa5_icon 'ban' %} disable</a>
			{% else %}
				<a class="btn btn-sm btn-primary" href="{% url 'fed:server-enable' server.pk %}">{% fa5_icon 'check' %} enable</a>
			{% endif %}
			{% if server.pull_enabled %}
				<a class="btn btn-sm btn-secondary" href="{% url 'fed:server-disable-pull' server.pk %}">{% fa5_icon 'ban' %} disable pull</a>
			{% else %}
				<a class="btn btn-sm btn-primary" href="{% url 'fed:server-enable-pull' server.pk %}">{% fa5_icon 'check' %} enable pull</a>
			{% endif %}
			<a class="btn btn-sm btn-primary" href="{% url 'fed:server-edit' server.pk %}">{% fa5_icon 'edit' %} edit</a>
		</td>
	</tr>
{% endfor %}
</table>

{% endblock %}
